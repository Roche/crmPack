<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
LogisticIndepBeta is the class for the two-parameters logistic regression
dose-limiting events (DLE) model with prior expressed in form of pseudo data.
This model describes the relationship between the binary DLE responses
and the dose levels. More specifically, it represents the relationship of the
probabilities of the occurrence of a DLE for corresponding dose levels in log
scale. This model is specified as
$$p(x) = exp(phi1 + phi2 * log(x)) / (1 + exp(phi1 + phi2 * log(x)))$$
where \(p(x)\) is the probability of the occurrence of a DLE at dose \(x\).
The two parameters of this model are the intercept \(phi1\) and the slope
\(phi2\). The LogisticIndepBeta inherits all slots from ModelTox class.
In the context of pseudo data, the following three arguments are used,
binDLE, DLEdose and DLEweights. The DLEdose represents fixed dose
levels at which the pseudo DLE responses binDLE are observed. DLEweights
represents total number of subjects treated per each dose level in DLEdose.
The binDLE represents the number of subjects observed with DLE per each
dose level in DLEdose. Hence, all these three vectors must be of the same
length and the order of the elements in any of the vectors binDLE,
DLEdose and DLEweights must be kept, so that an element of a given vector
corresponds to the elements of the remaining two vectors (see the example for
more insight).
Finally, since at least two DLE pseudo responses are needed to
obtain prior modal estimates (same as the maximum likelihood estimates) for
the model parameters, the binDLE, DLEdose and DLEweights must all be
vectors of at least length 2."><title>LogisticIndepBeta — LogisticIndepBeta-class • crmPack</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="LogisticIndepBeta — LogisticIndepBeta-class"><meta property="og:description" content="
LogisticIndepBeta is the class for the two-parameters logistic regression
dose-limiting events (DLE) model with prior expressed in form of pseudo data.
This model describes the relationship between the binary DLE responses
and the dose levels. More specifically, it represents the relationship of the
probabilities of the occurrence of a DLE for corresponding dose levels in log
scale. This model is specified as
$$p(x) = exp(phi1 + phi2 * log(x)) / (1 + exp(phi1 + phi2 * log(x)))$$
where \(p(x)\) is the probability of the occurrence of a DLE at dose \(x\).
The two parameters of this model are the intercept \(phi1\) and the slope
\(phi2\). The LogisticIndepBeta inherits all slots from ModelTox class.
In the context of pseudo data, the following three arguments are used,
binDLE, DLEdose and DLEweights. The DLEdose represents fixed dose
levels at which the pseudo DLE responses binDLE are observed. DLEweights
represents total number of subjects treated per each dose level in DLEdose.
The binDLE represents the number of subjects observed with DLE per each
dose level in DLEdose. Hence, all these three vectors must be of the same
length and the order of the elements in any of the vectors binDLE,
DLEdose and DLEweights must be kept, so that an element of a given vector
corresponds to the elements of the remaining two vectors (see the example for
more insight).
Finally, since at least two DLE pseudo responses are needed to
obtain prior modal estimates (same as the maximum likelihood estimates) for
the model parameters, the binDLE, DLEdose and DLEweights must all be
vectors of at least length 2."><meta property="og:image" content="https://roche.github.io/crmPack/main/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">crmPack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9000.9129</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/migration_from_the_old_crmPack.html">Migrating from crmPack version 1.0.3</a>
    <a class="dropdown-item" href="../articles/rolling-crm.html">Rolling CRM Example</a>
    <a class="dropdown-item" href="../articles/simulations.html">Simulation study example</a>
    <a class="dropdown-item" href="../articles/trial_analysis.html">Trial Analysis</a>
    <a class="dropdown-item" href="../articles/trial_definition.html">Trial Definition</a>
    <a class="dropdown-item" href="../articles/trial_simulation.html">Trial Simulation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/roche/crmPack">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1><code>LogisticIndepBeta</code></h1>
      <small class="dont-index">Source: <a href="https://github.com/roche/crmPack/blob/HEAD/R/Model-class.R" class="external-link"><code>R/Model-class.R</code></a></small>
      <div class="d-none name"><code>LogisticIndepBeta-class.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p><code>LogisticIndepBeta</code> is the class for the two-parameters logistic regression
dose-limiting events (DLE) model with prior expressed in form of pseudo data.
This model describes the relationship between the binary DLE responses
and the dose levels. More specifically, it represents the relationship of the
probabilities of the occurrence of a DLE for corresponding dose levels in log
scale. This model is specified as
$$p(x) = exp(phi1 + phi2 * log(x)) / (1 + exp(phi1 + phi2 * log(x)))$$
where \(p(x)\) is the probability of the occurrence of a DLE at dose \(x\).
The two parameters of this model are the intercept \(phi1\) and the slope
\(phi2\). The <code>LogisticIndepBeta</code> inherits all slots from <code><a href="ModelTox-class.html">ModelTox</a></code> class.</p>
<p>In the context of pseudo data, the following three arguments are used,
<code>binDLE</code>, <code>DLEdose</code> and <code>DLEweights</code>. The <code>DLEdose</code> represents fixed dose
levels at which the pseudo DLE responses <code>binDLE</code> are observed. <code>DLEweights</code>
represents total number of subjects treated per each dose level in <code>DLEdose</code>.
The <code>binDLE</code> represents the number of subjects observed with DLE per each
dose level in <code>DLEdose</code>. Hence, all these three vectors must be of the same
length and the order of the elements in any of the vectors <code>binDLE</code>,
<code>DLEdose</code> and <code>DLEweights</code> must be kept, so that an element of a given vector
corresponds to the elements of the remaining two vectors (see the example for
more insight).
Finally, since at least two DLE pseudo responses are needed to
obtain prior modal estimates (same as the maximum likelihood estimates) for
the model parameters, the <code>binDLE</code>, <code>DLEdose</code> and <code>DLEweights</code> must all be
vectors of at least length 2.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">LogisticIndepBeta</span><span class="op">(</span><span class="va">binDLE</span>, <span class="va">DLEdose</span>, <span class="va">DLEweights</span>, <span class="va">data</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>binDLE</dt>
<dd><p>(<code>numeric</code>)<br> the number of subjects observed with a DLE, the
pseudo DLE responses, depending on dose levels <code>DLEdose</code>.
Elements of <code>binDLE</code> must correspond to the elements of <code>DLEdose</code> and
<code>DLEweights</code>.</p></dd>


<dt>DLEdose</dt>
<dd><p>(<code>numeric</code>)<br> dose levels for the pseudo DLE responses.
Elements of <code>DLEdose</code> must correspond to the elements of <code>binDLE</code> and
<code>DLEweights</code>.</p></dd>


<dt>DLEweights</dt>
<dd><p>(<code>numeric</code>)<br> the total number of subjects treated at each
of the dose levels <code>DLEdose</code>, pseudo weights.
Elements of <code>DLEweights</code> must correspond to the elements of <code>binDLE</code> and
<code>DLEdose</code>.</p></dd>


<dt>data</dt>
<dd><p>(<code>Data</code>)<br> the input data to update estimates of the model
parameters.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The pseudo data can be interpreted as if we obtain some observations
before the trial starts. It can be used to express our prior, i.e. the
initial beliefs for the model parameters. The pseudo data is expressed in
the following way. First, fix at least two dose levels, then ask for experts'
opinion on how many subjects are to be treated at each of these dose levels
and on the number of subjects observed with a DLE. At each dose level, the
number of subjects observed with a DLE, divided by the total number of
subjects treated, is the probability of the occurrence of a DLE at that
particular dose level. The probabilities of the occurrence of a DLE based
on this pseudo data are independent and they follow Beta distributions.
Therefore, the joint prior probability density function of all these
probabilities can be obtained. Hence, by a change of variable, the joint
prior probability density function of the two parameters in this model can
also be obtained. In addition, a conjugate joint prior density function of
the two parameters in the model is used. For details about the form of all
these joint prior and posterior probability density functions, please refer
to Whitehead and Willamson (1998).</p>
    </div>
    <div class="section level2">
    <h2 id="slots">Slots<a class="anchor" aria-label="anchor" href="#slots"></a></h2>
    

<dl><dt><code>binDLE</code></dt>
<dd><p>(<code>numeric</code>)<br> a vector of total numbers of DLE responses.
It must be at least of length 2 and the order of its elements must
correspond to values specified in <code>DLEdose</code> and <code>DLEweights</code>.</p></dd>


<dt><code>DLEdose</code></dt>
<dd><p>(<code>numeric</code>)<br> a vector of the dose levels corresponding to
It must be at least of length 2 and the order of its elements must
correspond to values specified in <code>binDLE</code> and <code>DLEweights</code>.</p></dd>


<dt><code>DLEweights</code></dt>
<dd><p>(<code>integer</code>)<br> total number of subjects treated at each of
the pseudo dose level <code>DLEdose</code>.
It must be at least of length 2 and the order of its elements must
correspond to values specified in <code>binDLE</code> and <code>DLEdose</code>.</p></dd>


<dt><code>phi1</code></dt>
<dd><p>(<code>number</code>)<br>  the intercept of the model. This slot is used in
output to display the resulting prior or posterior modal estimate of the
intercept obtained based on the pseudo data and (if any) observed data/responses.</p></dd>


<dt><code>phi2</code></dt>
<dd><p>(<code>number</code>)<br>  the slope of the model. This slot is used in output
to display the resulting prior or posterior modal estimate of the slope
obtained based on the pseudo data and (if any) the observed data/responses.</p></dd>


<dt><code>Pcov</code></dt>
<dd><p>(<code>matrix</code>)<br> refers to the 2x2 covariance matrix of the intercept
(\(phi1\)) and the slope parameters (\(phi2\)) of the model.
This is used in output to display the resulting prior and posterior
covariance matrix of \(phi1\) and \(phi2\) obtained, based on the
pseudo data and (if any) the observed data and responses. This slot is
needed for internal purposes.</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Obtain prior modal estimates given the pseudo data.</span></span></span>
<span class="r-in"><span><span class="co"># First we used an empty data set such that only the dose levels under</span></span></span>
<span class="r-in"><span><span class="co"># investigations are given. In total, 12 dose levels are under investigation</span></span></span>
<span class="r-in"><span><span class="co"># ranging from 25 to 300 mg with increments of 25 (i.e 25, 50, 75, ..., 300).</span></span></span>
<span class="r-in"><span><span class="va">emptydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="Data-class.html">Data</a></span><span class="op">(</span>doseGrid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">300</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fix two dose levels 25 and 300 mg (DLEdose).</span></span></span>
<span class="r-in"><span><span class="co"># Total number of subjects treated in each of these levels is 3, (DLEweights).</span></span></span>
<span class="r-in"><span><span class="co"># The number of subjects observed with a DLE is 1.05 at dose 25 mg and 1.8 at dose 300 mg (binDLE).</span></span></span>
<span class="r-in"><span><span class="va">my_model1</span> <span class="op">&lt;-</span> <span class="fu">LogisticIndepBeta</span><span class="op">(</span></span></span>
<span class="r-in"><span>  binDLE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.05</span>, <span class="fl">1.8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  DLEdose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">300</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  DLEweights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">emptydata</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use observed DLE responses to obtain posterior modal estimates.</span></span></span>
<span class="r-in"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="Data-class.html">Data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">75</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">225</span>, <span class="fl">300</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  doseGrid <span class="op">=</span> <span class="va">emptydata</span><span class="op">@</span><span class="va">doseGrid</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Used default patient IDs!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Used best guess cohort indices!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">my_model2</span> <span class="op">&lt;-</span> <span class="fu">LogisticIndepBeta</span><span class="op">(</span></span></span>
<span class="r-in"><span>  binDLE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.05</span>, <span class="fl">1.8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  DLEdose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">300</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  DLEweights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">my_data</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Daniel Sabanes Bove, Wai Yin Yeung, Burak Kuersad Guenhan, Giuseppe Palermo, Thomas Jaki, Jiawen Zhu, Ziwei Liao, Dimitris Kontos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

